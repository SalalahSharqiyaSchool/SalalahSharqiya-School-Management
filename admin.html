<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <title>صفحة المدير - صلالة الشرقية للتعليم الأساسي</title>
    <link rel="stylesheet" href="css/style.css">
    <style>
        /* تنسيق جدول البيانات */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th, td {
            border: 1px solid #ccc;
            padding: 10px;
            text-align: center;
            font-size: 18px;
        }

        /* زر الطباعة */
        #printBtn {
            background-color: #0ABAB5;
            color: #fff;
            border: none;
            padding: 12px 25px;
            font-size: 20px;
            border-radius: 8px;
            cursor: pointer;
            margin-bottom: 15px;
        }

        #printBtn:hover {
            background-color: #079A95;
        }

        .logo-print {
            width: 80px;
            vertical-align: middle;
            margin-right: 10px;
        }
    </style>
</head>
<body>
    <header>
        <img src="css/logo.png" alt="شعار المدرسة" class="logo">
        <h1>صلالة الشرقية للتعليم الأساسي</h1>
    </header>

    <main>
        <h2>قائمة التعهدات</h2>
        <button id="printBtn">طباعة التعهد</button>

        <table id="teachersTable">
            <thead>
                <tr>
                    <th>الاسم</th>
                    <th>التخصص</th>
                    <th>الملاحظات</th>
                    <th>التوقيع</th>
                </tr>
            </thead>
            <tbody>
                <!-- البيانات سيتم تعبئتها من Firebase -->
            </tbody>
        </table>
    </main>

    <footer>
        <p>© 2025 جميع الحقوق محفوظة للأستاذ فيصل العريبي</p>
    </footer>

    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <script>
      const firebaseConfig = {
          apiKey: "AIzaSyA7LDHKX4XKKfCEbgmpEDQ5NHj6XghxZlE",
          authDomain: "salalah-sharqiya-school.firebaseapp.com",
          databaseURL: "https://salalah-sharqiya-school-default-rtdb.firebaseio.com/",
          projectId: "salalah-sharqiya-school",
          storageBucket: "salalah-sharqiya-school.firebasestorage.app",
          messagingSenderId: "540330149276",
          appId: "1:540330149276:web:228722d3f67b70ffa5f459"
      };

      firebase.initializeApp(firebaseConfig);
      const database = firebase.database();

      const tableBody = document.querySelector('#teachersTable tbody');

      // جلب البيانات من Firebase
      database.ref('teacherPledges').on('value', snapshot => {
          tableBody.innerHTML = ''; // مسح الجدول
          snapshot.forEach(childSnap => {
              const data = childSnap.val();
              const row = document.createElement('tr');

              row.innerHTML = `
                  <td>${data.name}</td>
                  <td>${data.specialty}</td>
                  <td>${data.notes}</td>
                  <td><img src="${data.signature}" style="width:120px; height:80px;"></td>
              `;
              tableBody.appendChild(row);
          });
      });

      // زر الطباعة
      document.getElementById('printBtn').addEventListener('click', () => {
          let printContent = `
              <div style="text-align:center;">
                  <img src="css/logo.png" class="logo-print">
                  <h2>صلالة الشرقية للتعليم الأساسي</h2>
                  <h3>تعهد المعلم</h3>
                  <p style="border:1px solid #ccc; padding:10px; font-size:18px;">
أتعهد بالالتزام بجميع قوانين وأنظمة مدرسة صلالة الشرقية للتعليم الأساسي، وأتعهد بالقيام بمسؤوليتي المهنية بأمانة وصدق.
أقر بأنني سألتزم بالحضور المبكر إلى المدرسة والانصراف في الوقت المحدد، وسأحافظ على النظام والانضباط داخل الصف وخارجه.
أتعهد بالتصرف بما يحقق المصلحة التعليمية للطلاب، وأدرك أن أي مخالفة لهذه التعهدات قد تؤدي إلى اتخاذ الإجراءات النظامية اللازمة.
                  </p>
              </div>
              <table style="width:100%; border-collapse:collapse; margin-top:15px; font-size:16px;">
                  <thead>
                      <tr>
                          <th style="border:1px solid #ccc; padding:8px;">الاسم</th>
                          <th style="border:1px solid #ccc; padding:8px;">التخصص</th>
                          <th style="border:1px solid #ccc; padding:8px;">الملاحظات</th>
                          <th style="border:1px solid #ccc; padding:8px;">التوقيع</th>
                      </tr>
                  </thead>
                  <tbody>
          `;

          // إضافة البيانات للجدول
          const rows = tableBody.querySelectorAll('tr');
          rows.forEach(r => {
              printContent += `<tr>${r.innerHTML}</tr>`;
          });

          printContent += `</tbody></table>`;

          const printWindow = window.open('', '', 'height=700,width=900');
          printWindow.document.write('<html><head><title>طباعة التعهد</title></head><body>');
          printWindow.document.write(printContent);
          printWindow.document.write('</body></html>');
          printWindow.document.close();
          printWindow.print();
      });
    </script>
</body>
</html>
